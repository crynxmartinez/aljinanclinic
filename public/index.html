<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Appointment - Clinic Management</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts - Arabic Support -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0066cc',
                        secondary: '#00cc66',
                    }
                }
            }
        }
    </script>
    
    <style>
        html {
            scroll-behavior: smooth;
        }
        
        /* Arabic Font */
        html[lang="ar"] {
            font-family: 'Cairo', sans-serif;
        }
        
        /* Arabic Text Spacing */
        html[lang="ar"] body {
            letter-spacing: 0.02em;
            word-spacing: 0.1em;
        }
        
        html[lang="ar"] h1,
        html[lang="ar"] h2,
        html[lang="ar"] h3,
        html[lang="ar"] h4 {
            letter-spacing: 0.03em;
            word-spacing: 0.15em;
        }
        
        html[lang="ar"] p,
        html[lang="ar"] span,
        html[lang="ar"] div {
            letter-spacing: 0.02em;
            word-spacing: 0.1em;
        }
        
        html[lang="ar"] button,
        html[lang="ar"] a {
            letter-spacing: 0.02em;
            word-spacing: 0.1em;
        }
        
        html[lang="ar"] label,
        html[lang="ar"] input,
        html[lang="ar"] textarea,
        html[lang="ar"] select {
            letter-spacing: 0.02em;
            word-spacing: 0.08em;
        }
        
        /* RTL Adjustments */
        html[dir="rtl"] .toast {
            animation: slideInRTL 0.3s ease-out;
        }
        
        @keyframes slideInRTL {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Keep Navigation LTR even in Arabic */
        html[dir="rtl"] nav {
            direction: ltr;
        }
        
        html[dir="rtl"] nav * {
            direction: ltr;
        }
        .section {
            min-height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.5s ease-out; }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .fade-in-up {
            animation: fadeInUp 0.8s ease-out;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner { animation: spin 1s linear infinite; }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast { animation: slideIn 0.3s ease-out; }
        
        .time-slot {
            transition: all 0.3s;
        }
        
        .time-slot:hover:not(.disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #0066cc 0%, #00cc66 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="bg-gray-100">
    
    <!-- Cookie Consent Banner -->
    <div id="cookie-banner" class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4 shadow-2xl z-50 transform translate-y-full transition-transform duration-500">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-start space-x-3">
                <i class="fas fa-cookie-bite text-3xl text-primary mt-1"></i>
                <div>
                    <h3 class="font-bold mb-1" data-translate="cookie.title">We Value Your Privacy</h3>
                    <p class="text-sm text-gray-300" data-translate="cookie.message">
                        We use cookies to enhance your experience, analyze site usage, and protect your health information in compliance with HIPAA.
                    </p>
                </div>
            </div>
            <div class="flex flex-wrap gap-2">
                <button onclick="acceptCookies()" class="bg-primary hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                    <i class="fas fa-check mr-2"></i><span data-translate="cookie.accept">Accept All</span>
                </button>
                <a href="/cookies.html" class="bg-gray-700 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                    <span data-translate="cookie.learn">Learn More</span>
                </a>
            </div>
        </div>
    </div>
    
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 bg-white shadow-md z-50">
        <div class="container mx-auto px-4 md:px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2 md:space-x-3">
                    <i class="fas fa-tooth text-primary text-2xl md:text-3xl"></i>
                    <span class="text-xl md:text-2xl font-bold text-gray-800">Smile Clinic</span>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:flex space-x-8 items-center">
                    <a href="#home" class="text-gray-700 hover:text-primary transition font-semibold" data-translate="nav.home">Home</a>
                    <a href="#about" class="text-gray-700 hover:text-primary transition font-semibold" data-translate="nav.about">About</a>
                    <a href="#booking" class="text-gray-700 hover:text-primary transition font-semibold" data-translate="nav.booking">Book Now</a>
                    
                    <!-- Language Switcher -->
                    <div class="flex items-center gap-2 bg-gray-100 rounded-lg p-1">
                        <button onclick="switchLanguage('en')" id="lang-en" class="px-3 py-1.5 rounded-md text-sm font-semibold transition bg-white text-primary shadow">
                            EN
                        </button>
                        <button onclick="switchLanguage('ar')" id="lang-ar" class="px-3 py-1.5 rounded-md text-sm font-semibold transition text-gray-600 hover:text-gray-800">
                            AR
                        </button>
                    </div>
                </div>
                
                <!-- Desktop Staff Login -->
                <a href="/login.html" class="hidden md:flex bg-gradient-to-r from-primary to-secondary text-white px-6 py-2.5 rounded-lg hover:shadow-lg transition font-semibold">
                    <i class="fas fa-sign-in-alt mr-2"></i><span data-translate="nav.staffLogin">Staff Login</span>
                </a>
                
                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="md:hidden text-gray-700 text-2xl focus:outline-none">
                    <i class="fas fa-bars" id="mobile-menu-icon"></i>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-200">
            <div class="container mx-auto px-4 py-4 space-y-3">
                <a href="#home" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-primary transition font-semibold py-2">
                    <i class="fas fa-home mr-2"></i><span data-translate="nav.home">Home</span>
                </a>
                <a href="#about" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-primary transition font-semibold py-2">
                    <i class="fas fa-info-circle mr-2"></i><span data-translate="nav.about">About</span>
                </a>
                <a href="#booking" onclick="toggleMobileMenu()" class="block text-gray-700 hover:text-primary transition font-semibold py-2">
                    <i class="fas fa-calendar-check mr-2"></i><span data-translate="nav.booking">Book Now</span>
                </a>
                
                <!-- Mobile Language Switcher -->
                <div class="flex items-center gap-2 bg-gray-100 rounded-lg p-1">
                    <button onclick="switchLanguage('en')" id="lang-en-mobile" class="flex-1 px-3 py-2 rounded-md text-sm font-semibold transition bg-white text-primary shadow">
                        English
                    </button>
                    <button onclick="switchLanguage('ar')" id="lang-ar-mobile" class="flex-1 px-3 py-2 rounded-md text-sm font-semibold transition text-gray-600 hover:text-gray-800">
                        العربية
                    </button>
                </div>
                
                <a href="/login.html" class="block bg-gradient-to-r from-primary to-secondary text-white px-6 py-3 rounded-lg hover:shadow-lg transition font-semibold text-center">
                    <i class="fas fa-sign-in-alt mr-2"></i><span data-translate="nav.staffLogin">Staff Login</span>
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Section 1: Hero -->
    <section id="home" class="section bg-gradient-to-br from-blue-50 to-green-50">
        <div class="container mx-auto px-6 text-center">
            <div class="fade-in-up">
                <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold text-gray-800 mb-6">
                    <span data-translate="hero.title1">Your Perfect</span> <span class="gradient-text" data-translate="hero.title2">Smile</span> <span data-translate="hero.title3">Starts Here</span>
                </h1>
                <p class="text-lg sm:text-xl md:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto" data-translate="hero.subtitle">
                    Experience world-class dental care with our team of expert dentists. We're committed to making your smile brighter and healthier.
                </p>
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <a href="#booking" class="bg-gradient-to-r from-primary to-secondary text-white px-8 py-4 rounded-lg text-lg font-semibold hover:shadow-2xl transition transform hover:scale-105">
                        <i class="fas fa-calendar-check mr-2"></i><span data-translate="hero.bookBtn">Book Appointment</span>
                    </a>
                    <a href="#about" class="bg-white text-primary border-2 border-primary px-8 py-4 rounded-lg text-lg font-semibold hover:bg-primary hover:text-white transition transform hover:scale-105">
                        <i class="fas fa-info-circle mr-2"></i><span data-translate="hero.learnBtn">Learn More</span>
                    </a>
                </div>
                <div class="mt-12 grid grid-cols-1 sm:grid-cols-3 gap-6 sm:gap-8 max-w-2xl mx-auto">
                    <div>
                        <div class="text-3xl sm:text-4xl font-bold text-primary">10+</div>
                        <div class="text-sm sm:text-base text-gray-600" data-translate="hero.stat1">Years Experience</div>
                    </div>
                    <div>
                        <div class="text-3xl sm:text-4xl font-bold text-primary">5000+</div>
                        <div class="text-sm sm:text-base text-gray-600" data-translate="hero.stat2">Happy Patients</div>
                    </div>
                    <div>
                        <div class="text-3xl sm:text-4xl font-bold text-primary">15+</div>
                        <div class="text-sm sm:text-base text-gray-600" data-translate="hero.stat3">Expert Dentists</div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Section 2: About -->
    <section id="about" class="section bg-white">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-5xl font-bold text-gray-800 mb-6" data-translate="about.title">Why Choose Us?</h2>
                    <p class="text-xl text-gray-600 mb-8" data-translate="about.subtitle">
                        We combine cutting-edge technology with compassionate care to deliver exceptional dental services.
                    </p>
                    <div class="space-y-6">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-primary rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-award text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2" data-translate="about.feature1Title">Expert Team</h3>
                                <p class="text-gray-600" data-translate="about.feature1Desc">Our dentists have years of experience and stay updated with the latest techniques.</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-secondary rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-cogs text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2" data-translate="about.feature2Title">Modern Technology</h3>
                                <p class="text-gray-600" data-translate="about.feature2Desc">State-of-the-art equipment ensures precise and comfortable treatments.</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-heart text-white text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2" data-translate="about.feature3Title">Patient-Centered Care</h3>
                                <p class="text-gray-600" data-translate="about.feature3Desc">Your comfort and satisfaction are our top priorities.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 shadow-lg">
                        <i class="fas fa-clock text-primary text-4xl mb-4"></i>
                        <h4 class="text-lg font-bold text-gray-800 mb-2" data-translate="about.card1Title">Flexible Hours</h4>
                        <p class="text-gray-600 text-sm" data-translate="about.card1Desc">Open 7 days a week</p>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 shadow-lg">
                        <i class="fas fa-shield-alt text-secondary text-4xl mb-4"></i>
                        <h4 class="text-lg font-bold text-gray-800 mb-2" data-translate="about.card2Title">Safe & Sterile</h4>
                        <p class="text-gray-600 text-sm" data-translate="about.card2Desc">Highest hygiene standards</p>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl p-6 shadow-lg">
                        <i class="fas fa-dollar-sign text-purple-500 text-4xl mb-4"></i>
                        <h4 class="text-lg font-bold text-gray-800 mb-2" data-translate="about.card3Title">Affordable</h4>
                        <p class="text-gray-600 text-sm" data-translate="about.card3Desc">Competitive pricing</p>
                    </div>
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl p-6 shadow-lg">
                        <i class="fas fa-smile-beam text-orange-500 text-4xl mb-4"></i>
                        <h4 class="text-lg font-bold text-gray-800 mb-2" data-translate="about.card4Title">5000+ Smiles</h4>
                        <p class="text-gray-600 text-sm" data-translate="about.card4Desc">Happy patients</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Section 3: Booking -->
    <section id="booking" class="section bg-gradient-to-br from-gray-50 to-blue-50">
        <div class="container mx-auto px-6 w-full">
            <div id="booking-type-selection" class="max-w-4xl mx-auto text-center">
                <h2 class="text-4xl font-bold text-gray-800 mb-4" data-translate="booking.title">Book Your Appointment</h2>
                <p class="text-gray-600 text-lg mb-8" data-translate="booking.subtitle">Schedule an appointment with your preferred doctor</p>
                <button onclick="startBooking()" class="bg-primary text-white px-8 py-4 rounded-lg font-bold text-lg hover:bg-blue-700 transition transform hover:scale-105">
                    <i class="fas fa-calendar-check mr-2"></i><span data-translate="booking.startBtn">Start Booking</span>
                </button>
            </div>
            
            <!-- Appointment Booking Flow -->
            <div id="appointment-flow" class="hidden max-w-4xl mx-auto">
                <button onclick="location.reload()" class="mb-4 text-primary hover:underline">
                    <i class="fas fa-arrow-left mr-2"></i><span data-translate="common.back">Back</span>
                </button>
                
                <!-- Step 1: Select Date -->
                <div id="step-date" class="bg-white rounded-xl shadow-lg p-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">
                        <i class="fas fa-calendar text-primary mr-2"></i><span data-translate="booking.selectDate">Select Date</span>
                    </h2>
                    <div id="calendar-container"></div>
                </div>
                
                <!-- Step 2: Select Doctor -->
                <div id="step-doctor" class="hidden bg-white rounded-xl shadow-lg p-8">
                    <button onclick="backToStep('date')" class="mb-4 text-primary hover:underline">
                        <i class="fas fa-arrow-left mr-2"></i><span data-translate="common.back">Back</span>
                    </button>
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">
                        <i class="fas fa-user-md text-primary mr-2"></i><span data-translate="booking.availableDoctors">Available Doctors</span>
                    </h2>
                    <p id="selected-date-display" class="text-center text-gray-600 mb-6"></p>
                    <div id="doctors-list" class="space-y-4"></div>
                </div>
                
                <!-- Step 3: Select Time -->
                <div id="step-time" class="hidden bg-white rounded-xl shadow-lg p-8">
                    <button onclick="backToStep('doctor')" class="mb-4 text-primary hover:underline">
                        <i class="fas fa-arrow-left mr-2"></i><span data-translate="common.back">Back</span>
                    </button>
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">
                        <i class="fas fa-clock text-primary mr-2"></i><span data-translate="booking.selectTime">Select Time</span>
                    </h2>
                    <p id="selected-info" class="text-center text-gray-600 mb-6"></p>
                    <div id="time-slots" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
                </div>
                
                <!-- Step 4: Patient Info -->
                <div id="step-info" class="hidden bg-white rounded-xl shadow-lg p-8">
                    <button onclick="backToStep('time')" class="mb-4 text-primary hover:underline">
                        <i class="fas fa-arrow-left mr-2"></i><span data-translate="common.back">Back</span>
                    </button>
                    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">
                        <i class="fas fa-user text-primary mr-2"></i><span data-translate="booking.yourInfo">Your Information</span>
                    </h2>
                    
                    <div class="bg-blue-50 border-l-4 border-primary p-4 mb-6 rounded">
                        <h3 class="font-bold text-gray-800 mb-2" data-translate="booking.summary">Appointment Summary:</h3>
                        <p id="summary-doctor"></p>
                        <p id="summary-date"></p>
                        <p id="summary-time"></p>
                    </div>
                    
                    <form id="appointment-form" class="space-y-4">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-translate="form.fullName">Full Name *</label>
                            <input type="text" id="apt-name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-translate="form.phone">Phone Number *</label>
                            <input type="tel" id="apt-phone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-translate="form.email">Email</label>
                            <input type="email" id="apt-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-translate="form.service">Service (Optional)</label>
                            <select id="apt-service" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                <option value="" data-translate="form.chooseService">Choose a service...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2" data-translate="form.symptoms">Symptoms / Reason for Visit</label>
                            <textarea id="apt-symptoms" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"></textarea>
                        </div>
                        
                        <!-- Enhanced Consent Section -->
                        <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-6">
                            <h4 class="font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-shield-alt text-primary mr-2"></i>
                                <span data-translate="form.consentTitle">Privacy & Consent</span>
                            </h4>
                            
                            <div class="space-y-3">
                                <label class="flex items-start cursor-pointer">
                                    <input type="checkbox" id="consent-checkbox" required class="mt-1 mr-3 w-5 h-5 text-primary focus:ring-2 focus:ring-primary">
                                    <span class="text-sm text-gray-700" data-translate="form.consent">
                                        I consent to the collection and use of my health information as described in the Privacy Policy and HIPAA Notice. I consent to receive appointment reminders via email, SMS, and WhatsApp.
                                    </span>
                                </label>
                                
                                <div class="flex flex-wrap gap-2 text-xs">
                                    <a href="/privacy.html" target="_blank" class="text-primary hover:underline flex items-center">
                                        <i class="fas fa-file-alt mr-1"></i><span data-translate="form.viewPrivacy">View Privacy Policy</span>
                                    </a>
                                    <span class="text-gray-400">|</span>
                                    <a href="/hipaa-notice.html" target="_blank" class="text-primary hover:underline flex items-center">
                                        <i class="fas fa-shield-alt mr-1"></i><span data-translate="form.viewHipaa">View HIPAA Notice</span>
                                    </a>
                                </div>
                                
                                <div class="bg-white rounded p-3 mt-3">
                                    <p class="text-xs text-gray-600 flex items-start">
                                        <i class="fas fa-lock text-green-600 mr-2 mt-0.5"></i>
                                        <span data-translate="form.dataProtection">Your data is encrypted and stored securely. We never sell your information to third parties. Data is retained indefinitely for comprehensive care.</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" id="submit-btn" class="w-full bg-primary text-white px-6 py-4 rounded-lg font-bold text-lg hover:bg-blue-700 transition">
                            <i class="fas fa-check mr-2"></i><span data-translate="form.confirmBtn">Confirm Booking</span>
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Success Message -->
            <div id="success-message" class="hidden max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-8 text-center">
                <div class="text-green-500 text-6xl mb-4">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4" data-translate="success.title">Thank You for Booking!</h2>
                <p class="text-lg text-gray-600 mb-6" data-translate="success.message">We've successfully received your appointment request and sent a confirmation email with all the details.</p>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded">
                    <div class="flex items-start">
                        <i class="fas fa-envelope text-blue-600 text-2xl mr-3 mt-1"></i>
                        <div class="text-left">
                            <h3 class="font-bold text-blue-800 mb-2" data-translate="success.emailTitle">Check Your Email</h3>
                            <p class="text-sm text-blue-700" data-translate="success.emailDesc">Please check your inbox (or spam folder) for your booking confirmation and appointment details.</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded">
                    <div class="flex items-start">
                        <i class="fab fa-whatsapp text-green-600 text-2xl mr-3 mt-1"></i>
                        <div class="text-left">
                            <h3 class="font-bold text-green-800 mb-2" data-translate="success.whatsappTitle">Get Updates on WhatsApp</h3>
                            <p class="text-sm text-green-700 mb-3" data-translate="success.whatsappDesc">Want to receive your booking details and updates via WhatsApp?</p>
                            <a href="https://wa.me/message/XBO5OWIQKXYLN1" target="_blank" class="inline-block bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition">
                                <i class="fab fa-whatsapp mr-2"></i><span data-translate="success.whatsappBtn">Click Here & Message "BOOK"</span>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="bg-purple-50 border-l-4 border-purple-500 p-4 mb-6 rounded">
                    <div class="flex items-start">
                        <i class="fas fa-clock text-purple-600 text-2xl mr-3 mt-1"></i>
                        <div class="text-left">
                            <h3 class="font-bold text-purple-800 mb-2" data-translate="success.pendingTitle">Awaiting Approval</h3>
                            <p class="text-sm text-purple-700" data-translate="success.pendingDesc">Your appointment is pending approval from our staff. We will contact you shortly to confirm your booking.</p>
                        </div>
                    </div>
                </div>
                
                <div id="success-details" class="bg-blue-50 border-l-4 border-primary p-4 mb-6 text-left rounded"></div>
                
                <button onclick="location.reload()" class="bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                    <i class="fas fa-plus mr-2"></i><span data-translate="success.anotherBtn">Make Another Booking</span>
                </button>
            </div>
        </div>
    </section>
    
    <!-- Security & Compliance Section -->
    <section class="py-12 bg-gradient-to-r from-blue-600 to-blue-800 text-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-8">
                <h3 class="text-3xl font-bold mb-2" data-translate="security.title">Your Privacy & Security Matters</h3>
                <p class="text-blue-100" data-translate="security.subtitle">We protect your health information with industry-leading security</p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-4xl mx-auto">
                <div class="text-center">
                    <div class="bg-white bg-opacity-20 rounded-xl p-6 hover:bg-opacity-30 transition">
                        <i class="fas fa-shield-alt text-5xl mb-3"></i>
                        <h4 class="font-bold mb-1" data-translate="security.hipaa">HIPAA Compliant</h4>
                        <p class="text-xs text-blue-100" data-translate="security.hipaaDesc">Protected Health Info</p>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white bg-opacity-20 rounded-xl p-6 hover:bg-opacity-30 transition">
                        <i class="fas fa-lock text-5xl mb-3"></i>
                        <h4 class="font-bold mb-1" data-translate="security.ssl">SSL Encrypted</h4>
                        <p class="text-xs text-blue-100" data-translate="security.sslDesc">256-bit Security</p>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white bg-opacity-20 rounded-xl p-6 hover:bg-opacity-30 transition">
                        <i class="fas fa-database text-5xl mb-3"></i>
                        <h4 class="font-bold mb-1" data-translate="security.data">Data Protected</h4>
                        <p class="text-xs text-blue-100" data-translate="security.dataDesc">Secure Storage</p>
                    </div>
                </div>
                <div class="text-center">
                    <div class="bg-white bg-opacity-20 rounded-xl p-6 hover:bg-opacity-30 transition">
                        <i class="fas fa-user-shield text-5xl mb-3"></i>
                        <h4 class="font-bold mb-1" data-translate="security.privacy">Privacy First</h4>
                        <p class="text-xs text-blue-100" data-translate="security.privacyDesc">Your Rights Protected</p>
                    </div>
                </div>
            </div>
            <div class="text-center mt-8">
                <a href="/privacy.html" class="text-white hover:text-blue-200 underline mr-4" data-translate="security.privacyLink">Privacy Policy</a>
                <a href="/hipaa-notice.html" class="text-white hover:text-blue-200 underline" data-translate="security.hipaaLink">HIPAA Notice</a>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="bg-gradient-to-r from-gray-900 to-gray-800 text-white mt-20">
        <div class="max-w-7xl mx-auto px-4 py-12">
            <div class="grid md:grid-cols-4 gap-8">
                <!-- About Section -->
                <div class="md:col-span-2">
                    <div class="flex items-center space-x-3 mb-4">
                        <i class="fas fa-tooth text-3xl text-primary"></i>
                        <h3 class="text-2xl font-bold" data-translate="footer.clinicName">Al Jinan Clinic</h3>
                    </div>
                    <p class="text-gray-300 mb-4" data-translate="footer.description">
                        Your trusted partner in dental care. We provide comprehensive dental services with state-of-the-art technology and experienced professionals.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 bg-primary rounded-full flex items-center justify-center hover:bg-blue-600 transition">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-primary rounded-full flex items-center justify-center hover:bg-blue-600 transition">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-primary rounded-full flex items-center justify-center hover:bg-blue-600 transition">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-primary rounded-full flex items-center justify-center hover:bg-blue-600 transition">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h4 class="text-lg font-bold mb-4" data-translate="footer.quickLinks">Quick Links</h4>
                    <ul class="space-y-2">
                        <li>
                            <a href="#hero" class="text-gray-300 hover:text-primary transition">
                                <i class="fas fa-chevron-right text-xs mr-2"></i><span data-translate="nav.home">Home</span>
                            </a>
                        </li>
                        <li>
                            <a href="#about" class="text-gray-300 hover:text-primary transition">
                                <i class="fas fa-chevron-right text-xs mr-2"></i><span data-translate="nav.about">About</span>
                            </a>
                        </li>
                        <li>
                            <a href="#booking" class="text-gray-300 hover:text-primary transition">
                                <i class="fas fa-chevron-right text-xs mr-2"></i><span data-translate="nav.booking">Book Appointment</span>
                            </a>
                        </li>
                        <li>
                            <a href="/login.html" class="text-gray-300 hover:text-primary transition">
                                <i class="fas fa-chevron-right text-xs mr-2"></i><span data-translate="nav.staffLogin">Staff Login</span>
                            </a>
                        </li>
                    </ul>
                </div>
                
                <!-- Contact Info -->
                <div>
                    <h4 class="text-lg font-bold mb-4" data-translate="footer.contact">Contact Us</h4>
                    <ul class="space-y-3 text-gray-300">
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt text-primary mt-1 mr-3"></i>
                            <span data-translate="footer.address">123 Dental Street, Medical District, City</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone text-primary mr-3"></i>
                            <span dir="ltr">+966 50 123 4567</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope text-primary mr-3"></i>
                            <span>info@aljinanclinic.com</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-clock text-primary mr-3"></i>
                            <span data-translate="footer.hours">Sun - Thu: 9AM - 9PM</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <!-- Bottom Bar -->
            <div class="border-t border-gray-700 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-400 text-sm mb-4 md:mb-0">
                    &copy; <span id="current-year"></span> <span data-translate="footer.copyright">Al Jinan Clinic. All rights reserved.</span>
                </p>
                <div class="flex space-x-6 text-sm text-gray-400">
                    <a href="#" class="hover:text-primary transition" data-translate="footer.privacy">Privacy Policy</a>
                    <a href="#" class="hover:text-primary transition" data-translate="footer.terms">Terms of Service</a>
                    <a href="#" class="hover:text-primary transition" data-translate="footer.cookies">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50"></div>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Modular JavaScript -->
    <script type="module" src="/js/pages/index-full.js"></script>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCjJLE_Mgrv3HONhkkgApmUNVlGdnAIcvI",
            authDomain: "clinic-a17bc.firebaseapp.com",
            projectId: "clinic-a17bc",
            storageBucket: "clinic-a17bc.firebasestorage.app",
            messagingSenderId: "5214960983",
            appId: "1:5214960983:web:4da52f47c510a50b3cd212",
            measurementId: "G-7YM2Z0BY98"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // GoHighLevel API v2 Configuration
        const GHL_API_KEY = 'pit-5b612d16-1609-43c6-a669-322e9197a9a9';
        const GHL_LOCATION_ID = 'xzA6eU8kOYmBuwFdr3CF';
        const GHL_API_BASE_URL = 'https://services.leadconnectorhq.com';
        
        // Helper function to upsert (create or update) contact in GoHighLevel
        async function upsertGHLContact(contactData) {
            try {
                const payload = {
                    locationId: GHL_LOCATION_ID,
                    email: contactData.email || '',
                    phone: contactData.phone || '',
                    tags: contactData.tags || [],
                    customFields: contactData.customFields || []
                };
                
                if (contactData.name) {
                    const nameParts = contactData.name.trim().split(' ');
                    payload.firstName = nameParts[0] || '';
                    payload.lastName = nameParts.slice(1).join(' ') || '';
                    payload.name = contactData.name;
                }
                
                console.log('Upserting GHL Contact:', payload);
                
                const response = await fetch(`${GHL_API_BASE_URL}/contacts/upsert`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GHL_API_KEY}`,
                        'Content-Type': 'application/json',
                        'Version': '2021-07-28'
                    },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('GHL API Error:', response.status, errorText);
                    throw new Error(`GHL API Error: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('GHL Contact Upserted Successfully:', data);
                return data;
            } catch (error) {
                console.error('Error upserting GHL contact:', error);
                return null;
            }
        }
        
        // Global Variables
        let selectedDoctor = null;
        let selectedDate = null;
        let selectedTime = null;
        let selectedDuration = 30;
        let allDoctors = [];
        let doctorProfiles = {};
        let doctorServices = [];
        let currentCalendarMonth = new Date().getMonth();
        let currentCalendarYear = new Date().getFullYear();
        let dataLoaded = false;
        
        // Utility Functions
        function showToast(message, type = 'success') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            };
            
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                warning: 'fa-exclamation-triangle',
                info: 'fa-info-circle'
            };
            
            const toast = document.createElement('div');
            toast.className = `toast ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg mb-2`;
            toast.innerHTML = `
                <div class="flex items-center space-x-2">
                    <i class="fas ${icons[type]}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.getElementById('toast-container').appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                toast.style.transition = 'all 0.3s ease-out';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        function formatDate(date) {
            if (typeof date === 'string') {
                date = new Date(date);
            }
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        function formatDateReadable(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }
        
        function formatTime12h(time24) {
            const [hours, minutes] = time24.split(':').map(Number);
            const period = hours >= 12 ? 'PM' : 'AM';
            const hour12 = hours === 0 ? 12 : hours > 12 ? hours - 12 : hours;
            return `${hour12}:${minutes.toString().padStart(2, '0')} ${period}`;
        }
        
        function parseTime(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }
        
        function formatTime(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
        }
        
        function formatPrice(price, currency = 'SAR') {
            if (!price) return 'Free';
            const symbols = { SAR: 'SR', USD: '$', EUR: '€', GBP: '£', AED: 'AED' };
            return `${symbols[currency] || 'SR'}${price}`;
        }
        
        // Preload Data Function
        async function preloadDoctorData() {
            if (dataLoaded) return;
            
            try {
                // Load all doctors and profiles in parallel
                const [usersSnap, profilesSnap] = await Promise.all([
                    db.collection('users').where('role', '==', 'doctor').get(),
                    db.collection('doctors').get()
                ]);
                
                allDoctors = usersSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                doctorProfiles = {};
                profilesSnap.docs.forEach(doc => {
                    const data = doc.data();
                    doctorProfiles[data.userId] = data;
                });
                
                dataLoaded = true;
                console.log('Doctor data preloaded:', allDoctors.length, 'doctors');
            } catch (error) {
                console.error('Error preloading doctor data:', error);
            }
        }
        
        // Preload data when page loads
        window.addEventListener('DOMContentLoaded', () => {
            preloadDoctorData();
        });
        
        // Navigation Functions
        async function startBooking() {
            document.getElementById('booking-type-selection').classList.add('hidden');
            document.getElementById('appointment-flow').classList.remove('hidden');
            
            // Ensure data is loaded before showing calendar
            if (!dataLoaded) {
                await preloadDoctorData();
            }
            
            renderCalendar();
        }
        
        function backToStep(step) {
            if (step === 'date') {
                document.getElementById('step-doctor').classList.add('hidden');
                document.getElementById('step-date').classList.remove('hidden');
                selectedDate = null;
            } else if (step === 'doctor') {
                document.getElementById('step-time').classList.add('hidden');
                document.getElementById('step-doctor').classList.remove('hidden');
                selectedDoctor = null;
            } else if (step === 'time') {
                document.getElementById('step-info').classList.add('hidden');
                document.getElementById('step-time').classList.remove('hidden');
                selectedTime = null;
            }
        }
        
        // Calendar Functions
        function renderCalendar() {
            const container = document.getElementById('calendar-container');
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1);
            const lastDay = new Date(currentCalendarYear, currentCalendarMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            
            let html = `
                <div class="mb-4 sm:mb-6">
                    <div class="flex items-center justify-between mb-3 sm:mb-4">
                        <button onclick="previousMonth()" class="px-2 py-1 sm:px-4 sm:py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition text-sm sm:text-base">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 class="text-base sm:text-xl md:text-2xl font-bold text-gray-800">${monthNames[currentCalendarMonth]} ${currentCalendarYear}</h3>
                        <button onclick="nextMonth()" class="px-2 py-1 sm:px-4 sm:py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition text-sm sm:text-base">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 sm:gap-2 mb-2">
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Sun</div>
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Mon</div>
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Tue</div>
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Wed</div>
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Thu</div>
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Fri</div>
                        <div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">Sat</div>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 sm:gap-2">
            `;
            
            for (let i = 0; i < startingDayOfWeek; i++) {
                html += '<div class="p-2 sm:p-3 md:p-4"></div>';
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentCalendarYear, currentCalendarMonth, day);
                const dateStr = formatDate(date);
                const isPast = date < today;
                
                if (isPast) {
                    html += `
                        <div class="border-2 border-gray-200 rounded-lg p-2 sm:p-3 md:p-4 text-center bg-gray-100 cursor-not-allowed opacity-50">
                            <p class="text-sm sm:text-base md:text-lg font-bold text-gray-400">${day}</p>
                        </div>
                    `;
                } else {
                    const isToday = date.getTime() === today.getTime();
                    html += `
                        <div onclick="selectDate('${dateStr}')" class="border-2 ${isToday ? 'border-primary bg-blue-50' : 'border-gray-200'} rounded-lg p-2 sm:p-3 md:p-4 text-center hover:border-primary hover:bg-blue-50 transition cursor-pointer">
                            <p class="text-sm sm:text-base md:text-lg font-bold ${isToday ? 'text-primary' : 'text-gray-800'}">${day}</p>
                        </div>
                    `;
                }
            }
            
            html += '</div></div>';
            container.innerHTML = html;
        }
        
        function previousMonth() {
            const today = new Date();
            currentCalendarMonth--;
            if (currentCalendarMonth < 0) {
                currentCalendarMonth = 11;
                currentCalendarYear--;
            }
            
            if (currentCalendarYear < today.getFullYear() || 
                (currentCalendarYear === today.getFullYear() && currentCalendarMonth < today.getMonth())) {
                currentCalendarMonth = today.getMonth();
                currentCalendarYear = today.getFullYear();
                showToast('Cannot select past dates', 'warning');
                return;
            }
            
            renderCalendar();
        }
        
        function nextMonth() {
            const maxMonthsAhead = 3;
            const today = new Date();
            const maxDate = new Date(today.getFullYear(), today.getMonth() + maxMonthsAhead, 1);
            
            currentCalendarMonth++;
            if (currentCalendarMonth > 11) {
                currentCalendarMonth = 0;
                currentCalendarYear++;
            }
            
            if (currentCalendarYear > maxDate.getFullYear() || 
                (currentCalendarYear === maxDate.getFullYear() && currentCalendarMonth > maxDate.getMonth())) {
                currentCalendarMonth--;
                if (currentCalendarMonth < 0) {
                    currentCalendarMonth = 11;
                    currentCalendarYear--;
                }
                showToast('Cannot book more than 3 months in advance', 'warning');
                return;
            }
            
            renderCalendar();
        }
        
        function selectDate(dateStr) {
            selectedDate = dateStr;
            
            // Show loading
            showToast('Loading doctors...', 'info');
            
            document.getElementById('step-date').classList.add('hidden');
            document.getElementById('step-doctor').classList.remove('hidden');
            
            document.getElementById('selected-date-display').textContent = 
                `Selected Date: ${formatDateReadable(dateStr)}`;
            
            loadDoctorsForDate(dateStr);
        }
        
        // Doctor Functions - Now uses preloaded data
        function loadDoctorsForDate(dateStr) {
            try {
                const doctorsList = document.getElementById('doctors-list');
                
                // Data is already loaded, filter instantly
                const date = new Date(dateStr);
                const dayName = date.toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
                
                const availableDoctors = allDoctors.filter(doctor => {
                    const profile = doctorProfiles[doctor.id];
                    if (!profile) return false;
                    
                    if (profile.offDates && profile.offDates.includes(dateStr)) {
                        return false;
                    }
                    
                    const schedule = profile.weeklySchedule?.[dayName];
                    return schedule && schedule.length > 0;
                });
                
                if (availableDoctors.length === 0) {
                    doctorsList.innerHTML = '<p class="text-center text-gray-600">No doctors available on this date. Please select another date.</p>';
                    return;
                }
                
                doctorsList.innerHTML = availableDoctors.map(doctor => {
                    const profile = doctorProfiles[doctor.id];
                    const specialty = profile?.specialty || 'General Practitioner';
                    return `
                        <div onclick="selectDoctor('${doctor.id}')" class="border-2 border-gray-200 rounded-lg p-6 hover:border-primary transition cursor-pointer">
                            <div class="flex items-center space-x-4">
                                <div class="w-16 h-16 bg-primary text-white rounded-full flex items-center justify-center text-2xl">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="text-xl font-bold text-gray-800">Dr. ${doctor.name}</h3>
                                    <p class="text-gray-600">${specialty}</p>
                                </div>
                                <i class="fas fa-chevron-right text-gray-400 text-2xl"></i>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Error loading doctors:', error);
                showToast('Error loading doctors', 'error');
            }
        }
        
        async function selectDoctor(doctorId) {
            selectedDoctor = allDoctors.find(d => d.id === doctorId);
            
            const servicesSnap = await db.collection('services').where('doctorId', '==', doctorId).get();
            doctorServices = servicesSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            
            document.getElementById('step-doctor').classList.add('hidden');
            document.getElementById('step-time').classList.remove('hidden');
            
            document.getElementById('selected-info').textContent = 
                `Doctor: Dr. ${selectedDoctor.name} | Date: ${formatDateReadable(selectedDate)}`;
            
            await loadTimeSlots();
        }
        
        // Time Slots Functions
        async function loadTimeSlots() {
            try {
                const timeSlotsDiv = document.getElementById('time-slots');
                timeSlotsDiv.innerHTML = '<p class="col-span-full text-center text-gray-600">Loading available times...</p>';
                
                const profileSnap = await db.collection('doctors').where('userId', '==', selectedDoctor.id).get();
                
                if (profileSnap.empty) {
                    timeSlotsDiv.innerHTML = '<p class="col-span-full text-center text-gray-600">No schedule available for this doctor.</p>';
                    return;
                }
                
                const profile = profileSnap.docs[0].data();
                const dayName = new Date(selectedDate).toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();
                const schedule = profile.weeklySchedule?.[dayName];
                
                if (!schedule || schedule.length === 0) {
                    timeSlotsDiv.innerHTML = '<p class="col-span-full text-center text-gray-600">Doctor not available on this day.</p>';
                    return;
                }
                
                const appointmentDuration = profile.appointmentDuration || 30;
                const bufferTime = profile.bufferTime || 10;
                const slotInterval = appointmentDuration + bufferTime;
                
                const slots = [];
                const startTime = schedule[0].start || '09:00';
                const endTime = schedule[0].end || '17:00';
                
                let current = parseTime(startTime);
                const end = parseTime(endTime);
                
                while (current + appointmentDuration <= end) {
                    slots.push({
                        time: formatTime(current),
                        duration: appointmentDuration
                    });
                    current += slotInterval;
                }
                
                const appointmentsSnap = await db.collection('appointments')
                    .where('doctorId', '==', selectedDoctor.id)
                    .where('date', '==', selectedDate)
                    .where('type', '==', 'appointment')
                    .get();
                
                const bookedTimes = appointmentsSnap.docs.map(doc => doc.data().startTime);
                
                timeSlotsDiv.innerHTML = slots.map(slot => {
                    const isBooked = bookedTimes.includes(slot.time);
                    const time12 = formatTime12h(slot.time);
                    return `
                        <div onclick="${isBooked ? '' : `selectTime('${slot.time}', ${slot.duration})`}" 
                             class="time-slot border-2 ${isBooked ? 'border-gray-300 bg-gray-100 cursor-not-allowed' : 'border-green-500 bg-green-50 hover:bg-green-100 cursor-pointer'} rounded-lg p-4 text-center transition">
                            <p class="text-lg font-bold ${isBooked ? 'text-gray-400' : 'text-green-700'}">${time12}</p>
                            <p class="text-xs ${isBooked ? 'text-gray-400' : 'text-green-600'}">${isBooked ? 'Booked' : slot.duration + ' min'}</p>
                        </div>
                    `;
                }).join('');
                
            } catch (error) {
                console.error('Error loading time slots:', error);
                showToast('Error loading time slots', 'error');
            }
        }
        
        function selectTime(time, duration) {
            selectedTime = time;
            selectedDuration = duration;
            
            const startMinutes = parseTime(time);
            const endTime = formatTime(startMinutes + duration);
            
            document.getElementById('step-time').classList.add('hidden');
            document.getElementById('step-info').classList.remove('hidden');
            
            document.getElementById('summary-doctor').textContent = `Doctor: Dr. ${selectedDoctor.name}`;
            document.getElementById('summary-date').textContent = `Date: ${formatDateReadable(selectedDate)}`;
            document.getElementById('summary-time').textContent = `Time: ${formatTime12h(time)} - ${formatTime12h(endTime)}`;
            
            const serviceSelect = document.getElementById('apt-service');
            serviceSelect.innerHTML = '<option value="">Choose a service...</option>';
            doctorServices.forEach(service => {
                const option = document.createElement('option');
                option.value = service.id;
                option.textContent = `${service.name} (${service.duration} min)`;
                serviceSelect.appendChild(option);
            });
        }
        
        // Form Submission
        document.getElementById('appointment-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('apt-name').value.trim();
            const phone = document.getElementById('apt-phone').value.trim();
            const email = document.getElementById('apt-email').value.trim();
            const serviceId = document.getElementById('apt-service').value;
            const symptoms = document.getElementById('apt-symptoms').value.trim();
            
            // Show loading state
            const submitBtn = document.getElementById('submit-btn');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
            
            try {
                const startMinutes = parseTime(selectedTime);
                const endTime = formatTime(startMinutes + selectedDuration);
                
                // Get doctor details from users collection
                const doctorDoc = await db.collection('users').doc(selectedDoctor.id).get();
                const doctorData = doctorDoc.data();
                
                // Get staff assigned to this doctor
                const staffSnapshot = await db.collection('users')
                    .where('role', '==', 'staff')
                    .where('assignedDoctors', 'array-contains', selectedDoctor.id)
                    .get();
                
                // Get first assigned staff
                let staffData = null;
                if (!staffSnapshot.empty) {
                    staffData = staffSnapshot.docs[0].data();
                }
                
                await db.collection('appointments').add({
                    type: 'appointment',
                    doctorId: selectedDoctor.id,
                    patientName: name,
                    patientPhone: phone,
                    patientEmail: email,
                    date: selectedDate,
                    startTime: selectedTime,
                    endTime: endTime,
                    duration: selectedDuration,
                    serviceId: serviceId || null,
                    status: 'booked',
                    symptoms: symptoms,
                    checkedIn: false,
                    notes: [],
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Prepare custom fields for GHL
                const customFields = [
                    {
                        key: 'appointment_date',
                        value: selectedDate
                    },
                    {
                        key: 'appointment_time',
                        value: selectedTime
                    },
                    {
                        key: 'booking_time',
                        value: selectedTime
                    },
                    {
                        key: 'booking_date_and_time',
                        value: `${selectedDate} at ${selectedTime}`
                    },
                    {
                        key: 'patient_phone_number',
                        value: phone
                    },
                    {
                        key: 'doctor',
                        value: selectedDoctor.name
                    },
                    {
                        key: 'doctor_email',
                        value: doctorData?.email || ''
                    },
                    {
                        key: 'doctor_phone',
                        value: doctorData?.phone || ''
                    }
                ];
                
                // Add staff info if available
                if (staffData) {
                    customFields.push(
                        {
                            key: 'staff',
                            value: staffData.name || ''
                        },
                        {
                            key: 'staff_email',
                            value: staffData.email || ''
                        },
                        {
                            key: 'staff_phone_number',
                            value: staffData.phone || ''
                        }
                    );
                }
                
                // Create patient contact in GoHighLevel immediately
                await upsertGHLContact({
                    name: name,
                    email: email,
                    phone: phone,
                    tags: ['Patient'],
                    customFields: customFields
                });
                
                document.getElementById('step-info').classList.add('hidden');
                document.getElementById('success-message').classList.remove('hidden');
                document.getElementById('success-details').innerHTML = `
                    <h4 class="font-bold text-gray-800 mb-3"><i class="fas fa-info-circle text-primary mr-2"></i>Appointment Details</h4>
                    <p class="mb-2"><strong>Doctor:</strong> Dr. ${selectedDoctor.name}</p>
                    <p class="mb-2"><strong>Date:</strong> ${formatDateReadable(selectedDate)}</p>
                    <p class="mb-2"><strong>Time:</strong> ${formatTime12h(selectedTime)} - ${formatTime12h(endTime)}</p>
                    <p class="mb-2"><strong>Patient:</strong> ${name}</p>
                    <p class="mb-2"><strong>Phone:</strong> ${phone}</p>
                `;
                
            } catch (error) {
                console.error('Error booking appointment:', error);
                showToast('Error booking appointment', 'error');
                
                // Reset button state on error
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
            }
        });
        
        // Mobile Menu Toggle Function
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            const menuIcon = document.getElementById('mobile-menu-icon');
            
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
                menuIcon.classList.remove('fa-bars');
                menuIcon.classList.add('fa-times');
            } else {
                mobileMenu.classList.add('hidden');
                menuIcon.classList.remove('fa-times');
                menuIcon.classList.add('fa-bars');
            }
        }
        
        // ============================================
        // LANGUAGE SYSTEM - BILINGUAL SUPPORT
        // ============================================
        
        // Translation Dictionary
        const translations = {
            en: {
                nav: {
                    home: 'Home',
                    about: 'About',
                    booking: 'Book Now',
                    staffLogin: 'Staff Login'
                },
                hero: {
                    title1: 'Your Perfect',
                    title2: 'Smile',
                    title3: 'Starts Here',
                    subtitle: 'Experience world-class dental care with our team of expert dentists. We\'re committed to making your smile brighter and healthier.',
                    bookBtn: 'Book Appointment',
                    learnBtn: 'Learn More',
                    stat1: 'Years Experience',
                    stat2: 'Happy Patients',
                    stat3: 'Expert Dentists'
                },
                about: {
                    title: 'Why Choose Us?',
                    subtitle: 'We combine cutting-edge technology with compassionate care to deliver exceptional dental services.',
                    feature1Title: 'Expert Team',
                    feature1Desc: 'Our dentists have years of experience and stay updated with the latest techniques.',
                    feature2Title: 'Modern Technology',
                    feature2Desc: 'State-of-the-art equipment ensures precise and comfortable treatments.',
                    feature3Title: 'Patient-Centered Care',
                    feature3Desc: 'Your comfort and satisfaction are our top priorities.',
                    card1Title: 'Flexible Hours',
                    card1Desc: 'Open 7 days a week',
                    card2Title: 'Safe & Sterile',
                    card2Desc: 'Highest hygiene standards',
                    card3Title: 'Affordable',
                    card3Desc: 'Competitive pricing',
                    card4Title: '5000+ Smiles',
                    card4Desc: 'Happy patients'
                },
                booking: {
                    title: 'Book Your Appointment',
                    subtitle: 'Schedule an appointment with your preferred doctor',
                    startBtn: 'Start Booking',
                    selectDate: 'Select Date',
                    availableDoctors: 'Available Doctors',
                    selectTime: 'Select Time',
                    yourInfo: 'Your Information',
                    summary: 'Appointment Summary:'
                },
                form: {
                    fullName: 'Full Name *',
                    phone: 'Phone Number *',
                    email: 'Email',
                    service: 'Service (Optional)',
                    chooseService: 'Choose a service...',
                    symptoms: 'Symptoms / Reason for Visit',
                    consentTitle: 'Privacy & Consent',
                    consent: 'I consent to the collection and use of my health information as described in the Privacy Policy and HIPAA Notice. I consent to receive appointment reminders via email, SMS, and WhatsApp.',
                    viewPrivacy: 'View Privacy Policy',
                    viewHipaa: 'View HIPAA Notice',
                    dataProtection: 'Your data is encrypted and stored securely. We never sell your information to third parties. Data is retained indefinitely for comprehensive care.',
                    confirmBtn: 'Confirm Booking'
                },
                success: {
                    title: 'Thank You for Booking!',
                    message: 'We\'ve successfully received your appointment request and sent a confirmation email with all the details.',
                    emailTitle: 'Check Your Email',
                    emailDesc: 'Please check your inbox (or spam folder) for your booking confirmation and appointment details.',
                    whatsappTitle: 'Get Updates on WhatsApp',
                    whatsappDesc: 'Want to receive your booking details and updates via WhatsApp?',
                    whatsappBtn: 'Click Here & Message "BOOK"',
                    pendingTitle: 'Awaiting Approval',
                    pendingDesc: 'Your appointment is pending approval from our staff. We will contact you shortly to confirm your booking.',
                    anotherBtn: 'Make Another Booking'
                },
                common: {
                    back: 'Back'
                },
                calendar: {
                    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                    days: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
                },
                footer: {
                    clinicName: 'Al Jinan Clinic',
                    description: 'Your trusted partner in dental care. We provide comprehensive dental services with state-of-the-art technology and experienced professionals.',
                    quickLinks: 'Quick Links',
                    contact: 'Contact Us',
                    address: '123 Dental Street, Medical District, City',
                    hours: 'Sun - Thu: 9AM - 9PM',
                    copyright: 'Al Jinan Clinic. All rights reserved.',
                    privacy: 'Privacy Policy',
                    terms: 'Terms of Service',
                    cookies: 'Cookie Policy'
                },
                cookie: {
                    title: 'We Value Your Privacy',
                    message: 'We use cookies to enhance your experience, analyze site usage, and protect your health information in compliance with HIPAA.',
                    accept: 'Accept All',
                    learn: 'Learn More'
                },
                security: {
                    title: 'Your Privacy & Security Matters',
                    subtitle: 'We protect your health information with industry-leading security',
                    hipaa: 'HIPAA Compliant',
                    hipaaDesc: 'Protected Health Info',
                    ssl: 'SSL Encrypted',
                    sslDesc: '256-bit Security',
                    data: 'Data Protected',
                    dataDesc: 'Secure Storage',
                    privacy: 'Privacy First',
                    privacyDesc: 'Your Rights Protected',
                    privacyLink: 'Privacy Policy',
                    hipaaLink: 'HIPAA Notice'
                }
            },
            ar: {
                nav: {
                    home: 'الرئيسية',
                    about: 'عن العيادة',
                    booking: 'احجز الآن',
                    staffLogin: 'تسجيل دخول الموظفين'
                },
                hero: {
                    title1: 'ابتسامتك المثالية',
                    title2: 'تبدأ',
                    title3: 'من هنا',
                    subtitle: 'استمتع برعاية أسنان عالمية المستوى مع فريقنا من أطباء الأسنان الخبراء. نحن ملتزمون بجعل ابتسامتك أكثر إشراقاً وصحة.',
                    bookBtn: 'احجز موعد',
                    learnBtn: 'اعرف المزيد',
                    stat1: 'سنوات من الخبرة',
                    stat2: 'مريض سعيد',
                    stat3: 'طبيب أسنان خبير'
                },
                about: {
                    title: 'لماذا تختارنا؟',
                    subtitle: 'نجمع بين التكنولوجيا المتطورة والرعاية الرحيمة لتقديم خدمات طب أسنان استثنائية.',
                    feature1Title: 'فريق خبير',
                    feature1Desc: 'أطباء الأسنان لدينا لديهم سنوات من الخبرة ويواكبون أحدث التقنيات.',
                    feature2Title: 'تكنولوجيا حديثة',
                    feature2Desc: 'معدات حديثة تضمن علاجات دقيقة ومريحة.',
                    feature3Title: 'رعاية تتمحور حول المريض',
                    feature3Desc: 'راحتك ورضاك هما أولوياتنا القصوى.',
                    card1Title: 'ساعات مرنة',
                    card1Desc: 'مفتوح 7 أيام في الأسبوع',
                    card2Title: 'آمن ومعقم',
                    card2Desc: 'أعلى معايير النظافة',
                    card3Title: 'أسعار معقولة',
                    card3Desc: 'أسعار تنافسية',
                    card4Title: '5000+ ابتسامة',
                    card4Desc: 'مرضى سعداء'
                },
                booking: {
                    title: 'احجز موعدك',
                    subtitle: 'حدد موعداً مع طبيبك المفضل',
                    startBtn: 'ابدأ الحجز',
                    selectDate: 'اختر التاريخ',
                    availableDoctors: 'الأطباء المتاحون',
                    selectTime: 'اختر الوقت',
                    yourInfo: 'معلوماتك',
                    summary: 'ملخص الموعد:'
                },
                form: {
                    fullName: 'الاسم الكامل *',
                    phone: 'رقم الهاتف *',
                    email: 'البريد الإلكتروني',
                    service: 'الخدمة (اختياري)',
                    chooseService: 'اختر خدمة...',
                    symptoms: 'الأعراض / سبب الزيارة',
                    consentTitle: 'الخصوصية والموافقة',
                    consent: 'أوافق على جمع واستخدام معلوماتي الصحية كما هو موضح في سياسة الخصوصية وإشعار HIPAA. أوافق على تلقي تذكيرات المواعيد عبر البريد الإلكتروني والرسائل النصية وواتساب.',
                    viewPrivacy: 'عرض سياسة الخصوصية',
                    viewHipaa: 'عرض إشعار HIPAA',
                    dataProtection: 'بياناتك مشفرة ومخزنة بشكل آمن. نحن لا نبيع معلوماتك لأطراف ثالثة أبداً. يتم الاحتفاظ بالبيانات إلى أجل غير مسمى للرعاية الشاملة.',
                    confirmBtn: 'تأكيد الحجز'
                },
                success: {
                    title: 'شكراً لك على الحجز!',
                    message: 'لقد تلقينا طلب موعدك بنجاح وأرسلنا بريداً إلكترونياً للتأكيد مع جميع التفاصيل.',
                    emailTitle: 'تحقق من بريدك الإلكتروني',
                    emailDesc: 'يرجى التحقق من صندوق الوارد الخاص بك (أو مجلد البريد العشوائي) للحصول على تأكيد الحجز وتفاصيل الموعد.',
                    whatsappTitle: 'احصل على التحديثات عبر واتساب',
                    whatsappDesc: 'هل تريد تلقي تفاصيل حجزك والتحديثات عبر واتساب؟',
                    whatsappBtn: 'انقر هنا وأرسل "BOOK"',
                    pendingTitle: 'في انتظار الموافقة',
                    pendingDesc: 'موعدك في انتظار الموافقة من موظفينا. سنتصل بك قريباً لتأكيد حجزك.',
                    anotherBtn: 'احجز موعد آخر'
                },
                common: {
                    back: 'رجوع'
                },
                calendar: {
                    months: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو', 'يوليو', 'أغسطس', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'],
                    days: ['الأحد', 'الإثنين', 'الثلاثاء', 'الأربعاء', 'الخميس', 'الجمعة', 'السبت']
                },
                footer: {
                    clinicName: 'عيادة الجنان',
                    description: 'شريكك الموثوق في رعاية الأسنان. نقدم خدمات أسنان شاملة بأحدث التقنيات وأطباء ذوي خبرة.',
                    quickLinks: 'روابط سريعة',
                    contact: 'اتصل بنا',
                    address: 'شارع طب الأسنان 123، المنطقة الطبية، المدينة',
                    hours: 'الأحد - الخميس: 9 صباحاً - 9 مساءً',
                    copyright: 'عيادة الجنان. جميع الحقوق محفوظة.',
                    privacy: 'سياسة الخصوصية',
                    terms: 'شروط الخدمة',
                    cookies: 'سياسة ملفات تعريف الارتباط'
                },
                cookie: {
                    title: 'نحن نقدر خصوصيتك',
                    message: 'نستخدم ملفات تعريف الارتباط لتحسين تجربتك وتحليل استخدام الموقع وحماية معلوماتك الصحية وفقاً لـ HIPAA.',
                    accept: 'قبول الكل',
                    learn: 'اعرف المزيد'
                },
                security: {
                    title: 'خصوصيتك وأمانك مهمان',
                    subtitle: 'نحمي معلوماتك الصحية بأمان رائد في الصناعة',
                    hipaa: 'متوافق مع HIPAA',
                    hipaaDesc: 'معلومات صحية محمية',
                    ssl: 'مشفر SSL',
                    sslDesc: 'أمان 256 بت',
                    data: 'بيانات محمية',
                    dataDesc: 'تخزين آمن',
                    privacy: 'الخصوصية أولاً',
                    privacyDesc: 'حقوقك محمية',
                    privacyLink: 'سياسة الخصوصية',
                    hipaaLink: 'إشعار HIPAA'
                }
            }
        };
        
        // Current language state
        let currentLanguage = 'en';
        
        // Arab countries list
        const arabCountries = ['SA', 'AE', 'QA', 'KW', 'BH', 'OM', 'JO', 'LB', 'EG', 'IQ', 'SY', 'YE', 'PS', 'LY', 'TN', 'DZ', 'MA', 'SD'];
        
        // Detect user's country and set default language
        async function detectLanguage() {
            try {
                // Check if language preference is already saved
                const savedLang = localStorage.getItem('preferredLanguage');
                if (savedLang) {
                    currentLanguage = savedLang;
                    updateLanguage(currentLanguage);
                    return;
                }
                
                // Try geolocation API
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                const countryCode = data.country_code;
                
                // Check if country is Arab
                if (arabCountries.includes(countryCode)) {
                    currentLanguage = 'ar';
                } else {
                    currentLanguage = 'en';
                }
                
                updateLanguage(currentLanguage);
            } catch (error) {
                console.log('Geolocation detection failed, using browser language');
                
                // Fallback to browser language
                const browserLang = navigator.language || navigator.userLanguage;
                if (browserLang.startsWith('ar')) {
                    currentLanguage = 'ar';
                } else {
                    currentLanguage = 'en';
                }
                
                updateLanguage(currentLanguage);
            }
        }
        
        // Switch language function
        function switchLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('preferredLanguage', lang);
            updateLanguage(lang);
        }
        
        // Update all text content based on language
        function updateLanguage(lang) {
            const html = document.documentElement;
            
            // Update HTML attributes
            html.setAttribute('lang', lang);
            html.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            
            // Update language switcher buttons
            const langEnBtn = document.getElementById('lang-en');
            const langArBtn = document.getElementById('lang-ar');
            const langEnMobile = document.getElementById('lang-en-mobile');
            const langArMobile = document.getElementById('lang-ar-mobile');
            
            if (lang === 'en') {
                langEnBtn.className = 'px-3 py-1.5 rounded-md text-sm font-semibold transition bg-white text-primary shadow';
                langArBtn.className = 'px-3 py-1.5 rounded-md text-sm font-semibold transition text-gray-600 hover:text-gray-800';
                langEnMobile.className = 'flex-1 px-3 py-2 rounded-md text-sm font-semibold transition bg-white text-primary shadow';
                langArMobile.className = 'flex-1 px-3 py-2 rounded-md text-sm font-semibold transition text-gray-600 hover:text-gray-800';
            } else {
                langEnBtn.className = 'px-3 py-1.5 rounded-md text-sm font-semibold transition text-gray-600 hover:text-gray-800';
                langArBtn.className = 'px-3 py-1.5 rounded-md text-sm font-semibold transition bg-white text-primary shadow';
                langEnMobile.className = 'flex-1 px-3 py-2 rounded-md text-sm font-semibold transition text-gray-600 hover:text-gray-800';
                langArMobile.className = 'flex-1 px-3 py-2 rounded-md text-sm font-semibold transition bg-white text-primary shadow';
            }
            
            // Update all elements with data-translate attribute
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                const keys = key.split('.');
                let translation = translations[lang];
                
                for (const k of keys) {
                    translation = translation[k];
                    if (!translation) break;
                }
                
                if (translation) {
                    element.textContent = translation;
                }
            });
            
            // Update calendar if it's rendered
            if (document.getElementById('calendar-container').innerHTML) {
                renderCalendar();
            }
        }
        
        // Override renderCalendar to use translated month/day names
        const originalRenderCalendar = renderCalendar;
        renderCalendar = function() {
            const container = document.getElementById('calendar-container');
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1);
            const lastDay = new Date(currentCalendarYear, currentCalendarMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            const monthNames = translations[currentLanguage].calendar.months;
            const dayNames = translations[currentLanguage].calendar.days;
            
            let html = `
                <div class="mb-4 sm:mb-6">
                    <div class="flex items-center justify-between mb-3 sm:mb-4">
                        <button onclick="previousMonth()" class="px-2 py-1 sm:px-4 sm:py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition text-sm sm:text-base">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 class="text-base sm:text-xl md:text-2xl font-bold text-gray-800">${monthNames[currentCalendarMonth]} ${currentCalendarYear}</h3>
                        <button onclick="nextMonth()" class="px-2 py-1 sm:px-4 sm:py-2 bg-gray-200 rounded-lg hover:bg-gray-300 transition text-sm sm:text-base">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 sm:gap-2 mb-2">
            `;
            
            dayNames.forEach(day => {
                html += `<div class="text-center font-semibold text-gray-600 text-xs sm:text-sm">${day}</div>`;
            });
            
            html += `</div><div class="grid grid-cols-7 gap-1 sm:gap-2">`;
            
            for (let i = 0; i < startingDayOfWeek; i++) {
                html += '<div class="p-2 sm:p-3 md:p-4"></div>';
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentCalendarYear, currentCalendarMonth, day);
                const dateStr = formatDate(date);
                const isPast = date < today;
                
                if (isPast) {
                    html += `
                        <div class="border-2 border-gray-200 rounded-lg p-2 sm:p-3 md:p-4 text-center bg-gray-100 cursor-not-allowed opacity-50">
                            <p class="text-sm sm:text-base md:text-lg font-bold text-gray-400">${day}</p>
                        </div>
                    `;
                } else {
                    const isToday = date.getTime() === today.getTime();
                    html += `
                        <div onclick="selectDate('${dateStr}')" class="border-2 ${isToday ? 'border-primary bg-blue-50' : 'border-gray-200'} rounded-lg p-2 sm:p-3 md:p-4 text-center hover:border-primary hover:bg-blue-50 transition cursor-pointer">
                            <p class="text-sm sm:text-base md:text-lg font-bold ${isToday ? 'text-primary' : 'text-gray-800'}">${day}</p>
                        </div>
                    `;
                }
            }
            
            html += '</div></div>';
            container.innerHTML = html;
        };
        
        // Cookie consent functions
        function acceptCookies() {
            localStorage.setItem('cookieConsent', 'accepted');
            document.getElementById('cookie-banner').classList.add('translate-y-full');
        }
        
        function showCookieBanner() {
            const consent = localStorage.getItem('cookieConsent');
            if (!consent) {
                setTimeout(() => {
                    document.getElementById('cookie-banner').classList.remove('translate-y-full');
                }, 1000);
            }
        }
        
        // Initialize language detection on page load
        window.addEventListener('DOMContentLoaded', () => {
            detectLanguage();
            
            // Set current year in footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // Show cookie banner if not accepted
            showCookieBanner();
        });
    </script>
</body>
</html>
